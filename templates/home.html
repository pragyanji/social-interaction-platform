{% extends "base.html" %}
{% load static %}
{% block title %}Home Â· ChatSphere{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{% static 'css/home.css' %}" />
<script id="firebase-config-data" type="application/json">{{ firebase_config|safe }}</script>
<script>
  window.FIREBASE_CONFIG = JSON.parse(document.getElementById('firebase-config-data').textContent);
</script>
{% endblock %}

{% block content %}

{% if request.user.is_authenticated %}

<div class="home-wrap">

  <!-- â”€â”€ Hero greeting â”€â”€ -->
  <div class="home-hero">
    <div class="hero-glow"></div>
    <div class="hero-text">
      <p class="hero-eyebrow">Welcome back</p>
      <h1 class="hero-name">{{ request.user.get_username }}<span class="hero-wave">ðŸ‘‹</span></h1>
      <p class="hero-sub">Ready to make some meaningful connections today?</p>
    </div>
    <div class="hero-avatar">
      {% if request.user.profile_pic %}
        <img src="{{ request.user.profile_pic.url }}" alt="{{ request.user.get_username }}" />
      {% else %}
        <img src="{% static 'img/default_profile.png' %}" alt="Avatar" />
      {% endif %}
    </div>
  </div>

  <!-- â”€â”€ Stat chips â”€â”€ -->
  <div class="stat-row">
    <div class="stat-chip aura-chip">
      <div class="chip-icon"><i class="fas fa-star-half-stroke"></i></div>
      <div class="chip-body">
        <span class="chip-val">{{ aura_points }}</span>
        <span class="chip-lbl">Aura Points</span>
      </div>
      <!-- Hover tooltip -->
      <div class="chip-tooltip">
        <p class="tt-title">ðŸ’« How Aura Works</p>
        <ul>
          <li><span class="tt-up">â†‘</span> Positive ratings (2â€“5 â˜…)</li>
          <li><span class="tt-up">â†‘</span> Daily streak bonus</li>
          <li><span class="tt-up">â†‘</span> More connections</li>
          <li><span class="tt-dn">â†“</span> Reports &amp; violations</li>
        </ul>
      </div>
    </div>

    <div class="stat-chip streak-chip">
      <div class="chip-icon"><i class="fas fa-fire"></i></div>
      <div class="chip-body">
        <span class="chip-val">{{ streak_days }}</span>
        <span class="chip-lbl">Day Streak</span>
      </div>
    </div>
  </div>

  <!-- â”€â”€ Action cards â”€â”€ -->
  <h2 class="section-heading">What would you like to do?</h2>

  <div class="action-grid">

    <!-- Messages -->
    <a class="action-card msg-card" href="{% url 'startmessagechat' %}">
      <div class="ac-glow"></div>
      <div class="ac-icon"><i class="fas fa-message"></i></div>
      <div class="ac-body">
        <h3 class="ac-title">Message Chat</h3>
        <p class="ac-desc">Text with people you've connected with during video chat.</p>
      </div>
      <div class="ac-arrow"><i class="fas fa-arrow-right"></i></div>
    </a>

    <!-- Video -->
    <a class="action-card vid-card" href="{% url 'startvideochat' %}">
      <div class="ac-glow"></div>
      <div class="ac-icon"><i class="fas fa-video"></i></div>
      <div class="ac-body">
        <h3 class="ac-title">Video Chat</h3>
        <p class="ac-desc">Go face-to-face with strangers from around the globe.</p>
      </div>
      <div class="ac-arrow"><i class="fas fa-arrow-right"></i></div>
    </a>

    <!-- Connections -->
    <a class="action-card conn-card" href="{% url 'connections' %}">
      <div class="ac-glow"></div>
      <div class="ac-icon"><i class="fas fa-user-group"></i></div>
      <div class="ac-body">
        <h3 class="ac-title">Connections</h3>
        <p class="ac-desc">View and manage the people you've connected with.</p>
      </div>
      <div class="ac-arrow"><i class="fas fa-arrow-right"></i></div>
    </a>

    <!-- Profile -->
    <a class="action-card prof-card" href="{% url 'profile' %}">
      <div class="ac-glow"></div>
      <div class="ac-icon"><i class="fas fa-user"></i></div>
      <div class="ac-body">
        <h3 class="ac-title">My Profile</h3>
        <p class="ac-desc">View your stats, streak, ratings, and edit your info.</p>
      </div>
      <div class="ac-arrow"><i class="fas fa-arrow-right"></i></div>
    </a>

  </div>
</div>

{% else %}

<!-- Unauthenticated splash -->
<div class="splash">
  <div class="splash-glow"></div>
  <h2 class="splash-title">Welcome to <span>ChatSphere</span></h2>
  <p class="splash-sub">Connect with real people from around the world through video &amp; messaging.</p>
  <div class="splash-btns">
    <a href="{% url 'signup' %}" class="btn-splash-primary">Create account</a>
    <a href="{% url 'signin' %}" class="btn-splash-ghost">Sign in</a>
  </div>
</div>

{% endif %}

{% endblock %}
